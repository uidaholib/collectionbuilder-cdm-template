---
# generate time-focused json data suitable for TimelineJS
---
{%- assign items = site.data.campus-buildings | where_exp: 'item', 'item.timeline-text' -%}
{
    "title": {
        "media": {
          "url": "{% include image/featured-image.html %}",
          "credit": {{ featuredItem.title | jsonify }}
        },
        "text": {
          "headline": {{ 'University of Idaho Campus Building Timeline' | jsonify }},
          "text": {{ 'Presenting U of I campus buildings according to their construction dates' | jsonify }}
        }
    },
    "events": [
      {% for item in items %}{% if item.date %}{
        "media": {
          "url": "{% include image/medium.html %}",
          "link": "{% include item-link.html %}",
          "credit": "<a target='_blank' href='{{ item.objectid | prepend: '/items/' | append: '.html' | relative_url }}'>{{ item.identifier }}</a>"
        },
        "start_date": { {% if item.date contains '-' %}{% assign dates = item.date | split: '-' %}
          "month": "{{ dates[1] }}",
          "day": "{{ dates[2] }}",
          "year": "{{ dates[0] }}"{% elsif item.date contains '/' %}"year": "{{ item.date | strip | split: '/' | last }}"{% else %}
          "year": "{{ item.date }}"{% endif %}
        },
        "text": {
          "headline": "<a href='{{ item.slug | prepend: '/buildings/' | append: '.html' | relative_url }}'>{{ item.title }}</a>"{% if item.timeline-text %},
          "text": {{ item.timeline-text | jsonify }}{% endif %}
        }
      }{% unless forloop.last %},{% endunless %}{% endif %}{% endfor %}
    ]
}
